<!-- HERO: Laptop with PK app + typing text -->
<section class="hero2">
  <div class="laptop">
    <!-- camera notch -->
    <div class="camera"></div>

    <!-- screen -->
    <div class="screen">
      <div class="pk-app">
        <!-- sidebar -->
        <aside class="panel">
          <h5>PK Inputs</h5>

          <label>CL
            <div class="slider-wrap">
              <input type="range" id="cl" min="1" max="20" step="0.5" value="5">
              <div class="ticks">
                <span>1</span><span>5</span><span>10</span><span>15</span><span>20</span>
              </div>
            </div>
          </label>

          <label>V
            <div class="slider-wrap">
              <input type="range" id="v" min="10" max="100" step="1" value="30">
              <div class="ticks">
                <span>10</span><span>30</span><span>50</span><span>70</span><span>100</span>
              </div>
            </div>
          </label>
          
          <!-- Oral-only inputs -->
          <div class="oral-only">
            <label>Ka
              <div class="slider-wrap">
                <input type="range" id="ka" min="0.1" max="3" step="0.1" value="1.2">
                <div class="ticks">
                  <span>0.1</span><span>1</span><span>2</span><span>3</span>
                </div>
              </div>
            </label>

            <label>F
              <div class="slider-wrap">
                <input type="range" id="f" min="0.1" max="1" step="0.05" value="1">
                <div class="ticks">
                  <span>0.1</span><span>0.5</span><span>1</span>
                </div>
              </div>
            </label>
          </div>

          <label>Dose
            <div class="slider-wrap">
              <input type="range" id="dose" min="50" max="1000" step="50" value="200">
              <div class="ticks">
                <span>50</span><span>250</span><span>500</span><span>750</span><span>1000</span>
              </div>
            </div>
          </label>

          <label>
            Route
            <select id="route" onchange="toggleRoute()">
                            <option value="iv">IV Bolus</option>
              <option value="oral" selected>Oral</option>
            </select>
          </label>

          <button onclick="simulate()">Simulate</button>
        </aside>

        <!-- chart area -->
        <div class="chart-area">
          <header>Time - Concentration - Solution</header>
          <svg id="chart" viewBox="0 0 600 280" class="pk-chart"></svg>
        </div>
      </div>
    </div>

    <!-- base/keyboard -->
    <div class="base"></div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
<script>
  function toggleRoute() {
    const route = document.getElementById("route").value;
    document.querySelectorAll(".oral-only").forEach(el => {
      el.style.display = (route === "oral") ? "block" : "none";
    });
  }

  // simple PK solver (1-compartment with first-order absorption or IV bolus)
  function simulate() {
    const CL = +document.getElementById("cl").value;
    const V = +document.getElementById("v").value;
    const Dose = +document.getElementById("dose").value;
    const route = document.getElementById("route").value;

    const k = CL / V;
    const times = [...Array(61).keys()].map(t => t * 0.5); // 0â€“30 h in 0.5 h steps
    let conc = [];

    let typedStrings = [];

    if (route === "oral") {
      const Ka = +document.getElementById("ka").value;
      const F = +document.getElementById("f").value;
      conc = times.map(t =>
        (F * Dose * Ka / (V * (Ka - k))) * (Math.exp(-k * t) - Math.exp(-Ka * t))
      );
      typedStrings = [
        'What is the solution you are looking for ?',
        'Simulation Complete.',
        `CL=${CL}, V=${V}, Ka=${Ka}, F=${F}, Dose=${Dose}`,
        'What is the solution you are looking for ?'
      ];
    } else {
      conc = times.map(t => (Dose / V) * Math.exp(-k * t));
      typedStrings = [
        'What is the solution you are looking for ?',
        'Simulation Complete.',
        `CL=${CL}, V=${V}, Dose=${Dose}`,
        'What is the solution you are looking for ?'
      ];
    }

    // Draw chart
    const svg = document.getElementById("chart");
    svg.innerHTML = ""; // reset

    // axes/grid
    for (let i = 0; i <= 4; i++) {
      let y = 240 - i * 60;
      svg.innerHTML += `<line x1="0" y1="${y}" x2="600" y2="${y}" stroke="rgba(255,255,255,.15)" />`;
    }

    // scale
    const maxC = Math.max(...conc) * 1.2;
    const scaleX = 600 / times[times.length - 1];
    const scaleY = 220 / maxC;

    // path for curve
    let d = "";
    conc.forEach((c, i) => {
      const x = times[i] * scaleX;
      const y = 240 - c * scaleY;
      d += (i === 0 ? "M" : "L") + x + "," + y;
    });
    svg.innerHTML += `<path d="${d}" fill="none" stroke="white" stroke-width="2" />`;

    // points (every 2 h)
    times.forEach((t, i) => {
      if (t % 2 === 0) {
        const x = t * scaleX;
        const y = 240 - conc[i] * scaleY;
        svg.innerHTML += `<circle cx="${x}" cy="${y}" r="3" fill="#00b4dc" />`;
      }
    });

    // dynamic caption (Typed.js inside SVG foreignObject)
    svg.innerHTML += `
<foreignObject x="20" y="240" width="560" height="40">
<div xmlns="http://www.w3.org/1999/xhtml" id="typed"
     style="font-family:monospace; font-size:24px; color:#00b4dc; line-height:1.4;">
</div>
      </foreignObject>
    `;

    new Typed("#typed", {
      strings: typedStrings,
      typeSpeed: 40,
      backSpeed: 20,
      backDelay: 1200,
      loop: true
    });
  }

  // run once on load
  toggleRoute();
  simulate();
</script>

<style>
.bmc-wrapper {
  display: inline-flex;
  font-family: ui-sans-serif, system-ui;
}

.footer-bar .bmc-wrapper {
  margin: 0 1em;
}

.hero2 {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 3rem 1rem;
  background: linear-gradient(180deg, #f7fafc, #eef4ff);
}
.laptop {
  position: relative;
  width: min(1300px, 120vw);
  aspect-ratio: 16 / 1; /* taller than 16/10 */
  border-radius: 18px;
  background: var(--bezel);
  box-shadow: 0 20px 50px rgba(8, 20, 48, .25);
  overflow: hidden;
}

.camera{position:absolute; top:8px; left:50%; transform:translateX(-50%);
  width:68px; height:12px; background:#060a12; border-radius:8px;
  box-shadow: inset 0 0 0 2px rgba(255,255,255,.05);}
.screen{position:absolute; inset:18px 18px 28px 18px;background:var(--screen);
  border-radius:12px; overflow:hidden;box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);}
.pk-app {
  display: grid;
  grid-template-columns: 400px 1fr; /* wider panel for more sliders */
  height: 100%;
  gap: 1rem; /* optional spacing between panel and chart */
}
.panel {
  background: var(--panel);
  padding: 1rem;
  color: var(--ink);
  border-right: 1px solid rgba(255,255,255,.06);
  overflow-y: auto;       /* allow scrolling */
  max-height: 100%;       /* still constrain to screen height */
  height: 100%;           /* take full height of the screen */
  display: flex;
  flex-direction: column;
  justify-content: flex-start; /* optional: align items from top */
  gap: 0.75rem;           /* spacing between sliders */
}
.panel h5{ margin:0 0 .75rem 0; font-size:0.95rem; }
.panel label{display:flex; flex-direction:column; font-size:.85rem; margin:.6rem 0;}
.panel input, .panel select{ width:100%; }
.panel button{margin-top:.8rem; width:100%; padding:.55rem .8rem;
  border:none; border-radius:10px; background:var(--accent); color:#04202a;
  font-weight:600; cursor:pointer;}

.chart-area{position:relative; padding:1rem; color:var(--ink); display:flex; flex-direction:column; height:100%;}
.chart-area header{font-size:1rem; opacity:.9; margin-bottom:.4rem;}
.pk-chart{ width:100%; height:100%; max-height:260px; background:#101826;}
.base{position:absolute; left:-3%; right:-3%; bottom:-14px; height:22px;
  background:linear-gradient(#aab3c0,#8f98a5); border-radius:0 0 22px 22px;
  box-shadow: 0 8px 18px rgba(10,20,40,.25);}
@media (max-width: 800px){
  .pk-app{ grid-template-columns: 1fr; }
  .panel{ border-right:none; border-bottom:1px solid rgba(255,255,255,.06); display:grid; grid-template-columns:1fr 1fr; gap:.5rem; }
  .panel h5{ grid-column:1/-1; }
  .panel button{ grid-column:1/-1; }
  .pk-chart{ max-height:200px; }
}

/* Slider ticks */
.slider-wrap {
  position: relative;
  width: 100%;
}
.ticks {
  display: flex;
  justify-content: space-between;
  font-size: 0.65rem;   /* smaller */
  margin-top: 0.15rem;  /* tighter */
  color: var(--ink);
}

</style>

